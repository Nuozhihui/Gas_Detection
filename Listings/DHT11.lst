C51 COMPILER V9.60.0.0   DHT11                                                             05/03/2022 03:46:48 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN .\Objects\DHT11.obj
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE Library\DHT11\DHT11.c COMPACT OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Library\ADC
                    -;.\Library\DHT11;.\Library\LCD;.\Library\STEP;.\Library\Show;.\Library\KEY;.\Library\MAX6675) DEBUG OBJECTEXTEND PRINT(.
                    -\Listings\DHT11.lst) TABS(2) OBJECT(.\Objects\DHT11.obj)

line level    source

   1          #include<reg51.h>
   2          
   3          #include<lcd.h>
   4          #include "DHT11.h"
   5          
   6          
   7          
   8          //----------------DHT11数据变量区-------------------------------
   9          extern unsigned int rec_dat[4];
  10          //unsigned char data_byte;
  11          //unsigned char rec_dat_lcd=[4];
  12          extern unsigned char rec_dat_lcd0[6];
  13          extern unsigned char rec_dat_lcd1[6];
  14          extern unsigned char rec_dat_lcd2[6];
  15          extern unsigned char rec_dat_lcd3[6];
  16          
  17          //DHT11起始信号
  18          
  19          void DHT11_start()  
  20          {
  21   1        Temp_data=1;
  22   1        
  23   1        DHT11_delay_us(2);
  24   1        
  25   1        Temp_data=0;
  26   1        
  27   1        DHT11_delay_ms(20);
  28   1        
  29   1        Temp_data=1;
  30   1        
  31   1        DHT11_delay_us(13);
  32   1        
  33   1      
  34   1      }
  35          
  36          //接收一个字节
  37          
  38          
  39          unsigned char DHT11_rec_byte()
  40          {
  41   1        
  42   1        unsigned char i,dat;
  43   1      
  44   1        
  45   1        for(i=0;i<8;i++)
  46   1        {
  47   2            while(!Temp_data);
  48   2            DHT11_delay_us(8);
  49   2            dat<<=1;
  50   2            if(Temp_data==1)
  51   2            {
  52   3              dat+=1;
  53   3            }
C51 COMPILER V9.60.0.0   DHT11                                                             05/03/2022 03:46:48 PAGE 2   

  54   2            while(Temp_data);
  55   2        }
  56   1      
  57   1        return dat;
  58   1      
  59   1        
  60   1      }
  61          
  62          
  63          //接收温湿度数据
  64          void DHT11_receive()
  65          {
  66   1        
  67   1        unsigned int R_H,R_L,T_H,T_L;
  68   1        unsigned char RH,RL,TH,TL,revise;
  69   1      
  70   1        DHT11_start();
  71   1        Temp_data=1;
  72   1        if(Temp_data==0)
  73   1        {
  74   2          while(Temp_data==0);   //等待拉高     
  75   2              DHT11_delay_us(40);  //拉高后延时80us
  76   2          
  77   2              R_H=DHT11_rec_byte();    //接收湿度高八位  
  78   2              R_L=DHT11_rec_byte();    //接收湿度低八位  
  79   2              T_H=DHT11_rec_byte();    //接收温度高八位  
  80   2              T_L=DHT11_rec_byte();    //接收温度低八位
  81   2              revise=DHT11_rec_byte(); //接收校正位
  82   2      
  83   2              DHT11_delay_us(25);    //结束
  84   2      
  85   2              if((R_H+R_L+T_H+T_L)==revise)      //校正
  86   2              {
  87   3                  RH=R_H;
  88   3                  RL=R_L;
  89   3                  TH=T_H;
  90   3                  TL=T_L;
  91   3        
  92   3              } 
  93   2            
  94   2              rec_dat[0]=RH;
  95   2              rec_dat[1]=RL;
  96   2      //        rec_dat[2]=TH;
  97   2      //        rec_dat[3]=TL;
  98   2      
  99   2        }
 100   1        
 101   1      }
 102          
 103          //延时us   --2*n+5us
 104          void DHT11_delay_us(unsigned char n)
 105          {
 106   1          while(--n);
 107   1      }
 108          
 109          //延时ms
 110          void DHT11_delay_ms(unsigned int z)
 111          {
 112   1         unsigned int i,j;
 113   1         for(i=z;i>0;i--)
 114   1            for(j=110;j>0;j--);
 115   1      }
C51 COMPILER V9.60.0.0   DHT11                                                             05/03/2022 03:46:48 PAGE 3   

 116          
 117          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    259    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----      15
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
